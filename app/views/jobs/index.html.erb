<!--<header class="masthead">
  <div class="intro-body">
    <div class="container">
      <div class="row">
        <div class="col-lg-8 mx-auto">
          <h1 class="brand-heading">Jobs</h1>

          <a href="#about" class="btn btn-circle js-scroll-trigger">
            <i class="fa fa-angle-double-down animated"></i>
          </a>
        </div>
      </div>
    </div>
  </div>
</header>
-->

<h1>Jobs</h1>
<table>
  <thead>
    <tr>
      <th>Bike</th>
      <th>Origin lat</th>
      <th>Origin lng</th>
      <th>Dest lat</th>
      <th>Dest lng</th>
      <th>Origin</th>
      <th>Destination</th>
      <th>Date</th>
      <th>Time</th>
      <th>Valet Assigned</th>
      <th>Current Status</th>
      <th>Client Email</th>
      <th colspan="3"></th>
    </tr>
  </thead>

 <tbody>
      <% @jobs.each do |job| %>
      <tr id="job_row_<%= job.id %>">
        <td><%= job.bike.bike_full %></td>
        <td><%= job.origin_lat %></td>
        <td><%= job.origin_lng %></td>
        <td><%= job.dest_lat %></td>
        <td><%= job.dest_lng %></td>
        <td><%= job.origin %></td>
        <td><%= job.destination %></td>
        <td><%= job.time.strftime("%B %d, %Y") %></td>
        <td><%= job.time.strftime("%I:%M:%S %p") %></td>
        <td class="valet"><%= job.valet_id %></td>
        <td><%= job.status %></td>
        <td><%= job.user.email %></td>
       
      <% case current_user.user_type %>
       <% when 'valet' %>
        <%= form_tag assign_valet_path, method: :put, remote: true do %>
        <%= hidden_field_tag :job_id, job.id %>
        <td><%= collection_select(nil, :valet_id, @valets, :id, :fullname, {prompt: true}, {onchange: "Rails.fire(document.querySelector('#job_row_#{job.id} form'), 'submit');"} ) %></td>
        <% end %>
      <% end %>
        
        <td><%= link_to 'Show', job %></td>
        <td><%= link_to 'Edit', edit_job_path(job) %></td>
        <td><%= link_to 'Destroy', job, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>
<%= javascript_include_tag "map" %>
<% case current_user.user_type %>
<% when 'valet' %>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCPJJsoaUUfc25r2O8ZSHIv5pFRHPHgaIc"></script>
<div id="map"></div>
<% end %>

<br>


<%= link_to "Create a new request", new_job_path %>
